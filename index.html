// ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const particles = [];
for (let i = 0; i < 50; i++) {
    particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2 + 1,
        speedX: Math.random() * 0.5 - 0.25,
        speedY: Math.random() * 0.5 - 0.25
    });
}

function animateParticles() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
    
    particles.forEach(particle => {
        particle.x += particle.speedX;
        particle.y += particle.speedY;
        
        if (particle.x < 0 || particle.x > canvas.width) particle.speedX *= -1;
        if (particle.y < 0 || particle.y > canvas.height) particle.speedY *= -1;
        
        ctx.beginPath();
        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
        ctx.fill();
    });
    
    requestAnimationFrame(animateParticles);
}
animateParticles();

// Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¸Ø§Ù‡Ø±
async function changeDisplayName() {
    const sessionId = document.getElementById('sessionId').value.trim();
    const newNickname = document.getElementById('newNickname').value.trim();
    const resultDiv = document.getElementById('result');
    const loadingDiv = document.getElementById('loading');
    const progressBar = document.getElementById('progress');

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
    if (!sessionId) {
        showResult('error', 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Session ID');
        return;
    }

    if (!newNickname) {
        showResult('error', 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯');
        return;
    }

    // Ø¥Ø¸Ù‡Ø§Ø± ØªØ­Ù…ÙŠÙ„
    loadingDiv.classList.remove('hidden');
    progressBar.classList.remove('hidden');
    resultDiv.classList.add('hidden');

    try {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØºÙŠÙŠØ±
        await new Promise(resolve => setTimeout(resolve, 3000));
        
        // Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        showResult('success', `
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 15px;">ğŸ‰</div>
                <h3 style="margin-bottom: 10px;">ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­!</h3>
                <p style="font-size: 1.2rem; margin-bottom: 10px;">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯: <strong>${newNickname}</strong></p>
                <p style="color: #666;">âœ… Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø³Ø¨Ø© 100%</p>
            </div>
        `);
        
    } catch (error) {
        showResult('error', `
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 15px;">âŒ</div>
                <h3 style="margin-bottom: 10px;">ÙØ´Ù„ ÙÙŠ ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù…</h3>
                <p>ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Session ID ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</p>
            </div>
        `);
    } finally {
        loadingDiv.classList.add('hidden');
        progressBar.classList.add('hidden');
    }
}

// Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
function showResult(type, message) {
    const resultDiv = document.getElementById('result');
    resultDiv.className = `result ${type}`;
    resultDiv.innerHTML = message;
    resultDiv.classList.remove('hidden');
}

// Ø¥Ø¶Ø§ÙØ© event listener Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„
document.addEventListener('DOMContentLoaded', function() {
    const inputs = document.querySelectorAll('input');
    inputs.forEach(input => {
        input.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                changeDisplayName();
            }
        });
    });
    
    // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    setTimeout(() => {
        document.querySelector('.container').style.opacity = '1';
        document.querySelector('.container').style.transform = 'translateY(0)';
    }, 100);
});

// ØªØ£Ø«ÙŠØ±Ø§Øª CSS Ø¥Ø¶Ø§ÙÙŠØ©
document.querySelector('.container').style.opacity = '0';
document.querySelector('.container').style.transform = 'translateY(20px)';
document.querySelector('.container').style.transition = 'all 0.5s ease';
